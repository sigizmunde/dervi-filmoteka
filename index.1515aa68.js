!function(){function e(e){return e&&e.__esModule?e.default:e}var t="undefined"!=typeof globalThis?globalThis:"undefined"!=typeof self?self:"undefined"!=typeof window?window:"undefined"!=typeof global?global:{},n={},a={},i=t.parcelRequire7d90;null==i&&((i=function(e){if(e in n)return n[e].exports;if(e in a){var t=a[e];delete a[e];var i={id:e,exports:{}};return n[e]=i,t.call(i.exports,i,i.exports),i.exports}var r=new Error("Cannot find module '"+e+"'");throw r.code="MODULE_NOT_FOUND",r}).register=function(e,t){a[e]=t},t.parcelRequire7d90=i),i.register("5k7tO",(function(e,t){"use strict";Object.defineProperty(e.exports,"__esModule",{value:!0}),e.exports.default=function(e,t){if(t.has(e))throw new TypeError("Cannot initialize the same private elements twice on an object")}}));var r="ed9b8dd4dcf22d9d746c4e21c6321e97",c={},o={};Object.defineProperty(o,"__esModule",{value:!0}),o.default=function(e,t){if(!(e instanceof t))throw new TypeError("Cannot call a class as a function")};var s={};Object.defineProperty(s,"__esModule",{value:!0}),s.default=function(e,t,n){if(!t.has(e))throw new TypeError("attempted to get private field on non-instance");return n};var l={};Object.defineProperty(l,"__esModule",{value:!0}),l.default=function(e,t){u.default(e,t),t.add(e)};var d,u=(d=i("5k7tO"))&&d.__esModule?d:{default:d};var v={};function h(e,t){for(var n=0;n<t.length;n++){var a=t[n];a.enumerable=a.enumerable||!1,a.configurable=!0,"value"in a&&(a.writable=!0),Object.defineProperty(e,a.key,a)}}Object.defineProperty(v,"__esModule",{value:!0}),v.default=function(e,t,n){t&&h(e.prototype,t);n&&h(e,n);return e};var m=new WeakSet,p=new WeakSet,f=function(){"use strict";function t(){if(e(o)(this,t),e(l)(this,m),e(l)(this,p),t._instance)return t._instance;t._instance=this}return e(v)(t,[{key:"getWatched",value:function(){try{var e=localStorage.getItem("watched");return null===e?[]:JSON.parse(e)}catch(e){console.error("Get state error: ",e)}return[]}},{key:"getQueue",value:function(){try{var e=localStorage.getItem("queue");return null===e?[]:JSON.parse(e)}catch(e){console.error("Get state error: ",e)}return[]}},{key:"addToWatched",value:function(t){var n=this.getWatched();n.includes(t)||(n.unshift(t),e(s)(this,m,y).call(this,n))}},{key:"removeFromWatched",value:function(t){var n=this.getWatched(),a=n.indexOf(t);a<0||(n.splice(a,1),e(s)(this,m,y).call(this,n))}},{key:"addToQueue",value:function(t){var n=this.getQueue();n.includes(t)||(n.unshift(t),e(s)(this,p,g).call(this,n))}},{key:"removeFromQueue",value:function(t){var n=this.getQueue(),a=n.indexOf(t);a<0||(n.splice(a,1),e(s)(this,p,g).call(this,n))}}]),t}();function y(e){try{localStorage.setItem("watched",JSON.stringify(e))}catch(e){console.error(e)}}function g(e){try{localStorage.setItem("queue",JSON.stringify(e))}catch(e){console.error(e)}}var b,L,w=new f,k=document.querySelector(".movie-modal"),S=document.querySelector(".backdrop"),T=k.querySelector("[data-close]");function q(e){k.classList.remove("open"),k.classList.add("is-hidden"),document.body.classList.remove("modal-open")}function W(e){var t=document.querySelector(".modal-content");t.innerHTML=e,b=t.querySelector("[data-queue-btn]"),L=t.querySelector("[data-watched-btn]");var n=Number(b.dataset.movieId);w.getQueue().includes(n)&&b.classList.add("active-btn"),w.getWatched().includes(n)&&L.classList.add("active-btn"),b.addEventListener("click",_),L.addEventListener("click",M)}function _(e){var t=e.target.dataset.movieId,n=Number(t);w.getWatched().includes(n)&&!b.classList.contains("active-btn")&&(w.removeFromWatched(n),L.classList.remove("active-btn")),e.target.classList.contains("active-btn")?(w.removeFromQueue(n),e.target.classList.remove("active-btn")):(w.addToQueue(n),e.target.classList.add("active-btn"))}function M(e){var t=e.target.dataset.movieId,n=Number(t);w.getQueue().includes(n)&&!L.classList.contains("active-btn")&&(w.removeFromQueue(n),b.classList.remove("active-btn")),e.target.classList.contains("active-btn")?(w.removeFromWatched(n),e.target.classList.remove("active-btn")):(w.addToWatched(n),e.target.classList.add("active-btn"))}document.querySelector(".card-section");function E(){c.cardsBox.innerHTML=""}function Q(e){var t="";e.map((function(e){t+='\n        <li class="card '.concat(e.watchedOrQueueClass,'">\n          <a href="" class="card-link card-button-slider" data-id="').concat(e.id,'">\n              <img\n                src="').concat(e.posterPath,'"\n                class="card-image"\n                alt=""\n              />\n              <div class="card-button-background">\n                <button class="card-button in-watched">watched</button>\n                <button class="card-button in-queue">queue</button>\n              </div>\n            \n              </a>\n              <div class="card-label-wrapper">\n                <div class="card-label-in-watched"></div>\n                <div class="card-label-in-queue"></div>\n              </div>\n            <div class="card-body">\n              <p class="card-title"><b>').concat(e.title,'</b></p>\n              <p class="card-genres"><b>').concat(e.genresInRow(3)," | ").concat(e.releaseDate,"</b></p>\n        </li>")})),function(e){c.cardsBox.innerHTML+=e}(t)}function x(e){W('\n      <div class="movie-picture-box">\n        <img\n          src="'.concat(e.posterPath,'"\n          alt="movie-picture"\n          class="movie-picture"\n        />\n      </div>\n      <div class="info-container">\n        <h1 class="movie-title">').concat(e.title,'</h1>\n        <ul class="movie-list">\n          <li class="movie-item">\n              <p class="movie-description">Vote / Votes</p>\n              <div class="vote-box property">\n              <p class="property-vote property-accent" id="vote">').concat(e.voteAverage,'</p>\n              <span class="vote-slash">/</span>\n              <p class="property-vote property-vote-alt" id="votes">').concat(e.voteCount,'</p>\n            </div>\n          </li>\n          <li class="movie-item">\n              <p class="movie-description">Popularity</p>\n              <p class="property" id="popularity">').concat(e.popularity,'</p>\n          </li>\n          <li class="movie-item">\n              <p class="movie-description">Original Title</p>\n              <p class="property" id="title">').concat(e.title,'</p>\n          </li>\n          <li class="movie-item">\n              <p class="movie-description">Genre</p>\n              <p class="property" id="genre">').concat(e.genresInRow(),'</p>\n          </li>\n          <li class="movie-item">\n          <p class="movie-description">Trailer</p>\n              <a href=').concat(e.video,' target="_blank" class="property">â–¶ Play</a>\n          </li>\n        </ul>\n        <article class="article">\n          <p class="article-caption">About</p>\n          <p class="article-text">\n            ').concat(e.overview,'\n          </p>\n        </article>\n        <div class="button-box">\n          <button class="movie-button watched-btn" data-watched-btn data-movie-id=').concat(e.id,'></button>\n          <button class="movie-button queue-btn" data-queue-btn data-movie-id=').concat(e.id,"></button>\n        </div>\n      </div>")),k.classList.remove("is-hidden"),k.classList.add("open"),document.body.classList.add("modal-open")}var O,B=function(){try{c.loader.classList.remove("is-hidden")}catch(e){console.log("loader failed ",e)}},P=function(){try{c.loader.classList.add("is-hidden")}catch(e){console.log("loader failed ",e)}};O=JSON.parse('{"genres":[{"id":28,"name":"Action"},{"id":12,"name":"Adventure"},{"id":16,"name":"Animation"},{"id":35,"name":"Comedy"},{"id":80,"name":"Crime"},{"id":99,"name":"Documentary"},{"id":18,"name":"Drama"},{"id":10751,"name":"Family"},{"id":14,"name":"Fantasy"},{"id":36,"name":"History"},{"id":27,"name":"Horror"},{"id":10402,"name":"Music"},{"id":9648,"name":"Mystery"},{"id":10749,"name":"Romance"},{"id":878,"name":"Science Fiction"},{"id":10770,"name":"TV Movie"},{"id":53,"name":"Thriller"},{"id":10752,"name":"War"},{"id":37,"name":"Western"},{"id":1982,"name":"Dummy"}]}');var F=new WeakSet,D=new WeakSet,N=function(){"use strict";function t(){if(e(o)(this,t),e(l)(this,F),e(l)(this,D),t._instance)return t._instance;t._instance=this,this.searchQuery="",this.genres=O.genres,this.repeatLastSearch=null,e(s)(this,D,C).call(this)}return e(v)(t,[{key:"getTrending",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1,n=arguments.length>1&&void 0!==arguments[1]&&arguments[1],a=this,i={resource:"trending",mediaType:"movie",timeWindow:n?"day":"week",get split(){return"".concat(this.resource,"/").concat(this.mediaType,"/").concat(this.timeWindow)}},c=new URLSearchParams({api_key:r,page:t});return this.repeatLastSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a.getTrending(e,n)},e(s)(this,F,I).call(this,i.split,c)}},{key:"searchMovie",value:function(t){var n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=this,i={resource:"search",mediaType:"movie",get split(){return"".concat(this.resource,"/").concat(this.mediaType)}},c=new URLSearchParams({api_key:r,page:n,query:t});return this.repeatLastSearch=function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:1;return a.searchMovie(t,e)},e(s)(this,F,I).call(this,i.split,c)}},{key:"getMovie",value:function(t){var n={resource:"movie",id:t,get split(){return"".concat(this.resource,"/").concat(this.id)}},a=new URLSearchParams({api_key:r});return e(s)(this,F,I).call(this,n.split,a)}},{key:"getVideos",value:function(t){var n={resource:"movie",id:t,mediaType:"videos",get split(){return"".concat(this.resource,"/").concat(this.id,"/").concat(this.mediaType)}},a=new URLSearchParams({api_key:r});return e(s)(this,F,I).call(this,n.split,a)}},{key:"getPremiers",value:function(){var t={resource:"movie",mediaType:"upcoming",get split(){return"".concat(this.resource,"/").concat(this.mediaType)}},n=new URLSearchParams({api_key:r});return e(s)(this,F,I).call(this,t.split,n)}},{key:"getGenres",value:function(){return this.genres}}]),t}();function I(e,t){return fetch("".concat("https://api.themoviedb.org/3","/").concat(e,"?").concat(t)).then((function(e){if(!e.ok)throw new Error(e.status);return e.json()}))}function C(){var t=this,n={resource:"genre",mediaType:"movie",list:"list",get split(){return"".concat(this.resource,"/").concat(this.mediaType,"/").concat(this.list)}},a=new URLSearchParams({api_key:r});e(s)(this,F,I).call(this,n.split,a).then((function(e){t.genres=e.genres,console.log("loadGenres complete")}))}function R(e,t){var n=document.querySelector(".pagination");if(n){var a=function(a){var r=document.createElement("li");r.classList.add("pagination-item");var c=document.createElement("a");c.classList.add("pagination-link"),c.innerText=e[a],e[a]===t&&r.classList.add("current"),"number"==typeof e[a]?c.addEventListener("click",(function(t){t.preventDefault,ne("repeat",e[a],"repeat")})):1===a?c.addEventListener("click",(function(t){t.preventDefault,ne("repeat",e[a+1]-1,"repeat")})):c.addEventListener("click",(function(t){t.preventDefault,ne("repeat",e[a-1]+1,"repeat")})),r.append(c),i.append(r),n.replaceChildren(i)},i=document.createElement("ul");i.classList.add("pagination-list");for(var r=0;r<e.length;r+=1)a(r);return n}}function j(e,t){if(0!==e){var n=e-3;if(1===e);else if(e<=7){R([1,2,3,4,5,6,7],t)}else e>7&&R(t<=3?[1,2,3,4,5,"...",e]:t>=n?[1,"...",e-4,e-3,e-2,e-1,e]:[1,"...",t-1,t,t+1,"...",e],t)}else U()}function U(){document.querySelector(".pagination").innerHTML=""}var A=new f,H=new WeakSet,V=new WeakSet,G=new WeakSet,J=new WeakSet,Y=new WeakSet,z=function(){"use strict";function t(n){if(e(o)(this,t),e(l)(this,H),e(l)(this,V),e(l)(this,G),e(l)(this,J),e(l)(this,Y),this.id=n.id,this.posterPath=e(s)(this,Y,ee).call(this,n.poster_path),this.title=n.title,this.originalTitle=n.original_title,this.popularity=n.popularity,this.genres=n.genre_ids,this.releaseDate=n.release_date.substr(0,4),this.inWatched=e(s)(this,V,X).call(this),this.inQueue=e(s)(this,G,Z).call(this),this.voteAverage=n.vote_average,this.voteCount=n.vote_count,this.popularity=n.popularity,this.overview=n.overview,this.videos=[],!this.genres){var a=this;this.genres=[],n.genres.map((function(e){a.genres.push(e.id)}))}}return e(v)(t,[{key:"genresInRow",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0;return e(s)(this,H,K).call(this,t)}},{key:"watchedOrQueueClass",get:function(){return this.inWatched?"in-watched":this.inQueue?"in-queue":""}},{key:"video",get:function(){return this.videos.length>0?this.videos[0]:""}},{key:"getVideos",value:function(){return te.getVideos(this.id)}}]),t}();function K(){for(var t=this,n=function(e){var n=t;if(a&&e===a-1&&e<t.genres.length-1)return r.push("others"),"break";var c=i.find((function(t){return t.id===n.genres[e]}));c&&r.push(c.name)},a=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,i=e(s)(this,J,$).call(this),r=[],c=0;c<this.genres.length;c++){var o=n(c);if("break"===o)break}return r.join(", ")}function X(){var e=this;return!!A.getWatched().find((function(t){return t===e.id}))}function Z(){var e=this;return!!A.getQueue().find((function(t){return t===e.id}))}function $(){return te.getGenres()}function ee(e){return"".concat("http://image.tmdb.org/t/p/w500").concat(e)}var te=new N;function ne(e){var t,n=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1,a=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"";B(),U(),console.log("getMovies with params ",e,n,a),e||(t=function(){return te.getTrending()}),e&&!a&&(t=function(){return te.searchMovie(e,n)}),e&&"repeat"===a&&(t=function(){return te.repeatLastSearch(n)}),e&&"premiers"===a&&(t=function(){return te.getPremiers()}),t().then((function(e){return console.log("Current page: ".concat(e.page,", total pages: ").concat(e.total_pages)),j(e.total_pages,e.page),e.results})).then((function(e){var t=[];e.map((function(e){var n=new z(e);t.push(n)})),E(),Q(t),P()})).catch((function(e){return console.log(e)}))}function ae(e){var t=[];e.map((function(e){t.push(te.getMovie(e).then((function(e){var t=new z(e);return e.genres=e.genres.map((function(e){return e.id})),t})).catch((function(e){return console.log(e),0})))})),Promise.all(t).then((function(e){Q(e.filter((function(e){return 0!=e})))})).catch((function(e){return console.log(e)}))}var ie=new f;function re(e,t){var n=e.closest(".card");if(n.classList.contains("in-queue"))return ie.removeFromQueue(t),void n.classList.remove("in-queue");n.classList.contains("in-watched")&&(ie.removeFromWatched(t),n.classList.remove("in-watched")),n.classList.add("in-queue"),ie.addToQueue(t)}function ce(e,t){var n=e.closest(".card");if(n.classList.contains("in-watched"))return ie.removeFromWatched(t),void n.classList.remove("in-watched");n.classList.contains("in-queue")&&(ie.removeFromQueue(t),n.classList.remove("in-queue")),n.classList.add("in-watched"),ie.addToWatched(t)}function oe(){window.scrollTo(0,0)}c.scrollTop=document.querySelector(".scroll-top"),(c.body=document.querySelector("body")).onscroll=function(){window.scrollY>230?c.scrollTop.classList.add("isShowScrollTop"):window.scrollY<230&&c.scrollTop.classList.remove("isShowScrollTop")};var se=new f,le=[],de=new IntersectionObserver((function(){if(console.log("i'm scrolling to the infinity"),le.length>6){return void ae(le.splice(0,6))}de.unobserve(c.observeTarget),ae(le)}),{rootMargin:"0px 0px 200px 0px"});function ue(e){e.preventDefault(),c.header.classList.remove("header-library"),c.header.classList.add("header-search"),c.pagination.classList.remove("on-empty-library"),c.cardsSection.classList.remove("empty-library"),c.cardsBox.classList.remove("hide-labels"),de.unobserve(c.observeTarget),c.searchInput.value="",E(),ne()}function ve(e){e.preventDefault(),c.header.classList.remove("header-search"),c.header.classList.add("header-library"),c.cardsBox.classList.add("hide-labels"),c.libraryWatchBtn.classList.add("accent-btn"),c.libraryQueBtn.classList.remove("accent-btn"),c.pagination.classList.add("on-empty-library"),0===se.getWatched().length?c.cardsSection.classList.add("empty-library"):he()}function he(){c.libraryWatchBtn.classList.remove("accent-btn"),c.libraryWatchBtn.classList.add("accent-btn"),c.libraryQueBtn.classList.remove("accent-btn"),0===se.getWatched().length?c.cardsSection.classList.add("empty-library"):(c.cardsSection.classList.remove("empty-library"),E(),le=se.getWatched(),de.observe(c.observeTarget))}function me(){c.libraryQueBtn.classList.remove("accent-btn"),c.libraryQueBtn.classList.add("accent-btn"),c.libraryWatchBtn.classList.remove("accent-btn"),0===se.getQueue().length?c.cardsSection.classList.add("empty-library"):(c.cardsSection.classList.remove("empty-library"),E(),le=se.getQueue(),de.observe(c.observeTarget))}function pe(){window.addEventListener("keydown",ye),c.teamModal.classList.remove("is-hidden"),document.body.classList.add("modal-open")}function fe(){window.removeEventListener("keydown",ye),c.teamModal.classList.add("is-hidden"),document.body.classList.remove("modal-open")}function ye(e){"Escape"===e.code&&fe()}function ge(e){e.currentTarget===e.target&&fe()}function be(e){e.preventDefault();var t=e.target.elements.query.value;c.cardsBox.innerHTML="",E(),ne(t)}function Le(e){e.preventDefault();var t=!1;e.path.map((function(e){if("BUTTON"===e.nodeName){var n=e.closest(".card-link").dataset.id,a=Number(n);e.classList.contains("in-queue")?re(e,a):e.classList.contains("in-watched")&&ce(e,a),t=!0}if("A"===e.nodeName&&!t){var i=e.dataset.id;(r=i)&&(te.getMovie(r).then((function(e){var t=new z(e);t.getVideos().then((function(e){e.results.map((function(e){"Trailer"===e.type&&t.videos.push("https://www.youtube.com/watch?v=".concat(e.key))})),console.log(t.videos),x(t)}))})),c.movieModal.classList.remove("is-hidden"))}var r}))}document.addEventListener("DOMContentLoaded",(function(){k=document.querySelector(".movie-modal"),S=document.querySelector(".backdrop"),T=k.querySelector("[data-close]"),S.addEventListener("click",q),T.addEventListener("click",q),c.loader=document.querySelector(".lds-ripple"),c.cardsBox=document.querySelector(".cards-box"),c.header=document.querySelector(".header"),c.homeLink=document.querySelector("#home"),c.libraryLink=document.querySelector("#library"),c.logo=document.querySelector("#logo"),c.libraryWatchBtn=document.querySelector("#lib-w"),c.libraryQueBtn=document.querySelector("#lib-q"),c.ourTeamLink=document.querySelector("#our-team"),c.closeModalBtn=document.querySelector('[data-action="close-modal"]'),c.backdrop=document.querySelector(".js-backdrop"),c.teamModal=document.querySelector(".js-team-modal"),c.movieModal=document.querySelector(".movie-modal"),c.searchForm=document.querySelector("#movie-search"),c.observeTarget=document.querySelector(".sentinel"),c.scrollTop=document.querySelector(".scroll-top"),c.body=document.querySelector("body"),c.cardsSection=document.querySelector(".cards-section"),c.pagination=document.querySelector(".pagination"),c.searchInput=document.querySelector(".search-input");try{c.logo.addEventListener("click",ue),c.homeLink.addEventListener("click",ue),c.libraryLink.addEventListener("click",ve),c.libraryWatchBtn.addEventListener("click",he),c.libraryQueBtn.addEventListener("click",me),c.ourTeamLink.addEventListener("click",pe),c.closeModalBtn.addEventListener("click",fe),c.backdrop.addEventListener("click",ge),c.searchForm.addEventListener("submit",be),c.cardsBox.addEventListener("click",Le),c.scrollTop.addEventListener("click",oe)}catch(e){console.log(e)}ne(),se.getQueue(),se.getWatched()}));new f}();
//# sourceMappingURL=index.1515aa68.js.map
